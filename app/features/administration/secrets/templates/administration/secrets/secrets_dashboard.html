{% extends "base.html" %}

{% block title %}Secrets Management - Admin{% endblock %}

{% block head %}
<!-- Stats Card Web Component -->
<script src="/dashboard/static/js/stats-card.js?v=tabler"></script>
<!-- Administration Dashboard Styles -->
<!-- Table Base JavaScript -->
<script src="/features/core/static/js/table-base.js"></script>
{% endblock %}

{% block content %}

<!-- Statistics Cards -->
<div class="row mb-4">
    <div class="col-sm-6 col-lg-3">
        <stats-card
            id="total-secrets-card"
            title="Total Secrets"
            description="All secrets in system"
            icon="ti ti-key"
            color="blue"
            data-url="/features/administration/secrets/api/stats"
            data-key="total_secrets"
            auto-refresh="300000">
        </stats-card>
    </div>

    <div class="col-sm-6 col-lg-3">
        <stats-card
            id="active-secrets-card"
            title="Active Secrets"
            description="Currently active secrets"
            icon="ti ti-check-circle"
            color="green"
            data-url="/features/administration/secrets/api/stats"
            data-key="active_secrets"
            auto-refresh="300000">
        </stats-card>
    </div>

    <div class="col-sm-6 col-lg-3">
        <stats-card
            id="expiring-secrets-card"
            title="Expiring Soon"
            description="Next 30 days"
            icon="ti ti-alert-triangle"
            color="orange"
            data-url="/features/administration/secrets/api/stats"
            data-key="expiring_soon"
            auto-refresh="300000">
        </stats-card>
    </div>

    <div class="col-sm-6 col-lg-3">
        <stats-card
            id="secret-types-card"
            title="Secret Types"
            description="Categories in use"
            icon="ti ti-category"
            color="primary"
            data-url="/features/administration/secrets/api/stats"
            data-key="by_type"
            data-transform="Object.keys(data).length"
            auto-refresh="300000">
        </stats-card>
    </div>
</div>

<!-- Advanced Filters -->
<div class="card mb-4">
    <div class="card-body">
        <h5 class="card-title mb-3">Advanced Filters</h5>
        <form onsubmit="applyFilters(); return false;">
            <div class="row g-3">
                <div class="col-md-4">
                    <label class="form-label">Secret Type</label>
                    <select class="form-select" id="type-filter">
                        <option value="">All Types</option>
                        <option value="api_key">API Key</option>
                        <option value="password">Password</option>
                        <option value="token">Token</option>
                        <option value="certificate">Certificate</option>
                        <option value="other">Other</option>
                    </select>
                </div>
                <div class="col-md-4">
                    <label class="form-label">Status</label>
                    <select class="form-select" id="status-filter">
                        <option value="">All Statuses</option>
                        <option value="true">Active</option>
                        <option value="false">Inactive</option>
                    </select>
                </div>
                <div class="col-md-4">
                    <label class="form-label">&nbsp;</label>
                    <div class="d-flex gap-2">
                        <button type="submit" class="btn btn-primary">
                            <i class="ti ti-filter me-2"></i>Apply Filters
                        </button>
                        <button type="button" class="btn btn-outline-secondary" onclick="clearFilters()">
                            <i class="ti ti-x me-2"></i>Clear
                        </button>
                    </div>
                </div>
            </div>
        </form>
    </div>
</div>

<div id="secrets-area">
  <div id="secrets-table-container">
    {% include "administration/secrets/partials/list_content.html" %}
  </div>
</div>

<!-- Tabler Modal -->
<div class="modal modal-blur fade" id="modal" tabindex="-1" role="dialog" aria-hidden="true">
  <div class="modal-dialog modal-lg modal-dialog-centered" role="document">
    <div class="modal-content">
      <div id="modal-body">
        <!-- Modal content will be loaded here -->
      </div>
    </div>
  </div>
</div>

{% endblock %}

{% block scripts %}
<!-- Secrets table configuration (Tabulator operations) -->
<script src="/features/administration/secrets/static/js/secrets-table.js"></script>
{% endblock %}
