{% extends "base.html" %}

{% block title %}Messages{% endblock %}

{% block content %}
<div class="page-header d-print-none mb-2">
    <div class="row align-items-center">
        <div class="col">
            <div class="page-pretitle">Community</div>
            <h2 class="page-title">{{ page_title }}</h2>
            <div class="text-muted mt-1">{{ page_description }}</div>
        </div>
        <div class="col-auto ms-auto">
            <div class="btn-group">
                <button class="btn btn-primary" hx-get="/features/community/messages/partials/form" hx-target="#conversation-rail" hx-swap="afterbegin">
                    <i class="ti ti-edit me-1"></i> New Conversation
                </button>
                <button class="btn btn-outline-secondary" hx-get="/features/community/messages/partials/conversations" hx-target="#conversation-rail" hx-swap="innerHTML">
                    <i class="ti ti-refresh"></i>
                </button>
            </div>
        </div>
    </div>
</div>

<div class="card p-0" style="border: none;">
    <div class="row g-0" style="min-height: 70vh;">
        <div class="col-12 col-lg-4 border-end">
            <div id="conversation-rail"
                 class="h-100"
                 hx-get="/features/community/messages/partials/conversations"
                 hx-trigger="load"
                 hx-target="this"
                 hx-swap="innerHTML">
                <div class="p-3 text-center text-muted">Loading conversationsâ€¦</div>
            </div>
        </div>
        <div class="col-12 col-lg-8">
            <div id="thread-pane" class="h-100 d-flex flex-column">
                <div class="empty m-0 p-5">
                    <div class="empty-icon"><i class="ti ti-messages"></i></div>
                    <p class="empty-title">Select a conversation</p>
                    <p class="empty-subtitle text-muted">Choose someone on the left to start chatting.</p>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script>
  window.currentMemberId = "{{ member_id }}";
</script>
<script src="/features/community/static/js/messages_htmx.js"></script>
{% endblock %}
