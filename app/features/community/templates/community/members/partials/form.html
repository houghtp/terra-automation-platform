<div class="modal-header">
    <h5 class="modal-title">
        {{ "Edit Member" if member else "Add Member" }}
    </h5>
</div>

<form
    id="member-form"
    {% if member %}
        hx-put="/features/community/members/{{ member.id }}"
    {% else %}
        hx-post="/features/community/members/"
    {% endif %}
    hx-disabled-elt="fieldset"
    autocomplete="off"
>
    <div class="modal-body">
        <fieldset class="form-fieldset">
            <div class="row g-3">
                <div class="col-md-6">
                    <label class="form-label required">Name</label>
                    <input
                        type="text"
                        name="name"
                        value="{{ form_data.name if form_data and form_data.name is not none else (member.name if member else '') }}"
                        class="form-control {{ 'is-invalid' if errors and errors.get('name') }}"
                        maxlength="255"
                        required
                    >
                    {% if errors and errors.get('name') %}
                        <div class="invalid-feedback d-block">{{ errors['name'][0] }}</div>
                    {% endif %}
                </div>
                <div class="col-md-6">
                    <label class="form-label required">Email</label>
                    <input
                        type="email"
                        name="email"
                        value="{{ form_data.email if form_data and form_data.email is not none else (member.email if member else '') }}"
                        class="form-control {{ 'is-invalid' if errors and errors.get('email') }}"
                        maxlength="255"
                        required
                    >
                    {% if errors and errors.get('email') %}
                        <div class="invalid-feedback d-block">{{ errors['email'][0] }}</div>
                    {% endif %}
                </div>

                <div class="col-md-6">
                    <label class="form-label">Location</label>
                    <input
                        type="text"
                        name="location"
                        value="{{ form_data.location if form_data and form_data.location is not none else (member.location if member else '') }}"
                        class="form-control"
                        maxlength="255"
                    >
                </div>

                <div class="col-md-6">
                    <label class="form-label">AUM Range</label>
                    <input
                        type="text"
                        name="aum_range"
                        value="{{ form_data.aum_range if form_data and form_data.aum_range is not none else (member.aum_range if member else '') }}"
                        class="form-control"
                        maxlength="100"
                        placeholder="e.g. $100M - $250M"
                    >
                </div>

                <div class="col-md-6">
                    <label class="form-label">Partner</label>
                    <select
                        name="partner_id"
                        class="form-select {{ 'is-invalid' if errors and errors.get('partner_id') }}"
                    >
                        <option value="">-- None --</option>
                        {% for partner in partner_options or [] %}
                            <option
                                value="{{ partner.id }}"
                                {% if (form_data and form_data.partner_id == partner.id) or (member and member.partner_id == partner.id) %}selected{% endif %}
                            >{{ partner.name }}</option>
                        {% endfor %}
                    </select>
                    {% if errors and errors.get('partner_id') %}
                        <div class="invalid-feedback d-block">{{ errors['partner_id'][0] }}</div>
                    {% endif %}
                </div>

                <div class="col-md-6">
                    <label class="form-label">Specialties</label>
                    <input
                        type="text"
                        name="specialties"
                        value="{{ specialties_text }}"
                        class="form-control"
                        placeholder="Comma separated (e.g. succession, tax)"
                    >
                </div>

                <div class="col-md-6">
                    <label class="form-label">Tags</label>
                    <input
                        type="text"
                        name="tags"
                        value="{{ tags_text }}"
                        class="form-control"
                        placeholder="Comma separated labels"
                    >
                </div>

                <div class="col-12">
                    <label class="form-label">Bio</label>
                    <textarea
                        name="bio"
                        class="form-control"
                        rows="3"
                    >{{ form_data.bio if form_data and form_data.bio is not none else (member.bio if member else '') }}</textarea>
                </div>
            </div>
        </fieldset>
    </div>

    <div class="modal-footer">
        <button type="button" class="btn btn-outline-secondary" data-bs-dismiss="modal">
            Cancel
        </button>
        <button type="submit" class="btn btn-primary">
            <span class="htmx-indicator spinner-border spinner-border-sm me-2" role="status"></span>
            {{ "Save Changes" if member else "Create Member" }}
        </button>
    </div>
</form>
